<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-back-button slot="start" defaultHref="" (click)="dismiss()"></ion-back-button>
    <ion-title>{{"details" | translate}}</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content>
  <!-- <div *ngIf="loader; else otherContent">
    <app-skeleton></app-skeleton>
  </div>
  <ng-template #otherContent> -->
  <ion-accordion-group [value]=this.openAccordion class="ion-padding">
    <ng-container *ngIf="user.role == 'ATTENDER' && !!data.location">
      <ion-accordion value="first" *ngIf="!!data.location">
        <ion-item slot="header" color="light">
          <i class="fa-solid fa-file-lines"></i>
          <ion-label class="ion-padding-horizontal">{{"bloodBankDetails" | translate}}</ion-label>
        </ion-item>
        <div class="ion-padding accordion-collapsed" slot="content">
          <ion-card>
            <ion-card-content>
              <ion-grid>
                <ion-row>
                  <ion-col size="12">
                    <ion-label class="head">{{"bloodBankName" | translate}} </ion-label>
                    <ion-label> : {{data?.bloodBankName}}</ion-label>
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col size="12">
                    <ion-label class="head">{{"location" | translate}} </ion-label>
                    <ion-label> : {{data?.location}}</ion-label>
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col size="12">
                    <ion-label class="head">{{"donationDate" | translate}} </ion-label>
                    <ion-label> : {{data?.donationDate}}</ion-label>
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col *ngIf="data.status == 'ALLOCATED'">
                    <ion-button (click)="statusUpdate('ACCEPTED')">{{"accept" | translate}}</ion-button>
                  </ion-col>
                  <ion-col *ngIf="data.status == 'ACCEPTED'">
                    <ion-button (click)="statusUpdate('DONE')">{{"done" | translate}}</ion-button>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-card-content>
          </ion-card>
        </div>
      </ion-accordion>
    </ng-container>

    <ng-container *ngIf="user.role == 'ADMIN' && !data.bloodRequest">
      <ion-accordion value="first">
        <ion-item slot="header" color="light">
          <i class="fa-solid fa-file-lines"></i>
          <ion-label class="ion-padding-horizontal">{{"bloodBankDetails" | translate}}</ion-label>
        </ion-item>
        <div class="ion-padding accordion-collapsed" slot="content">
          <ion-card>
            <ion-card-content>
              <form [formGroup]="bloodDonateForm" *ngIf="edit">
                <ion-row class="ion-align-items-center ion-justify-content-center">
                  <ion-col size="12">
                    <ion-label position="floating" lablePlacement="stacked">{{"bloodBankName" | translate}}</ion-label>
                    <ion-item  class="input input-class">
                      <ion-input placeholder="Blood Bank" formControlName="bloodBankName"></ion-input>
                    </ion-item>
                  </ion-col>
                </ion-row>

                <ion-row class="ion-align-items-center ion-justify-content-center">
                  <ion-col size="12">
                    <ion-label position="floating" lablePlacement="stacked">{{"location" | translate}}</ion-label>
                    <ion-item  class="input input-class">
                      <ion-input placeholder="Location" formControlName="location"></ion-input>
                    </ion-item>
                  </ion-col>
                </ion-row>
                <ion-row class="ion-align-items-center ion-justify-content-center">
                  <ion-col size="12">
                    <ion-label position="floating" lablePlacement="stacked">{{"donationDate" | translate}}</ion-label>
                    <ion-item class="input-class">
                      <p class="ion-margin-end">
                        {{f['donationDate'].value | date}}
                      </p>
                      <ion-icon slot="end" color="primary" name="calendar-outline" datetime="datetime"
                        class="ion-margin-top" (click)="openCalender(f['donationDate'].value)"></ion-icon>
                    </ion-item>
                  </ion-col>
                </ion-row>
                <ion-row class="ion-text-center">
                  <ion-col *ngIf="!data.location">
                    <ion-button expand="block" (click)="allocate()">{{"allocate" | translate}}</ion-button>
                  </ion-col>
                  <ion-col size="6" *ngIf="data.location">
                    <ion-button expand="block" (click)="edit = !edit">{{"CANCEL" | translate}}</ion-button>
                  </ion-col>
                  <ion-col size="6" *ngIf="data.location">
                    <ion-button expand="block" (click)="allocate()">{{"Re-Allocate" | translate}}</ion-button>
                  </ion-col>
                </ion-row>
              </form>

              <ion-grid *ngIf="!edit">
                <ion-item *ngIf="data.status != 'DONE' && data.status != 'CLOSE'" class="ion-no-padding ion-no-margin"
                  lines="none">
                  <ion-icon slot="end" color="primary" name="create-outline" (click)="editData()"></ion-icon>
                </ion-item>
                <ion-row>
                  <ion-col size="12">
                    <ion-label class="head">{{"bloodBankName" | translate}} </ion-label>
                    <ion-label> : {{data?.bloodBankName}}</ion-label>
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col size="12">
                    <ion-label class="head">{{"location" | translate}} </ion-label>
                    <ion-label> : {{data?.location}}</ion-label>
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col size="12">
                    <ion-label class="head">{{"donationDate" | translate}} </ion-label>
                    <ion-label> : {{data?.donationDate}}</ion-label>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-card-content>
          </ion-card>
        </div>
      </ion-accordion>
    </ng-container>

    <ion-accordion value="second" *ngIf="!!data.bloodRequest">
      <ion-item slot="header" color="light">
        <i class="fa-solid fa-droplet"></i>
        <ion-label class="ion-padding-horizontal">{{"beneficiary" | translate}}</ion-label>
      </ion-item>
      <div class="ion-padding" slot="content">
        <ion-card>
          <ion-card-content>
            <ion-grid>
              <ion-row>
                <ion-col size="12">
                  <ion-label class="head">{{"Name" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.name}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="12">
                  <ion-label class="head">{{"gender" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.gender}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="12">
                  <ion-label class="head">{{"age" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.age}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="12">
                  <ion-label class="head">{{"bloodGroup" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.bloodGroup}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="12">
                  <ion-label class="head">{{"RequireDate" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.bloodRequireDate}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="12">
                  <ion-label class="head">{{"state" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.state}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row *ngIf="!!data?.bloodRequest.district">
                <ion-col size="12">
                  <ion-label class="head">{{"District" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.district}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row *ngIf="!!data?.bloodRequest.tahsil">
                <ion-col size="12">
                  <ion-label class="head">{{"Tahsil" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.tahsil}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row *ngIf="!!data?.bloodRequest.village">
                <ion-col size="12">
                  <ion-label class="head">{{"Village" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.village}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row *ngIf="data?.bloodRequest?.gender == 'FEMALE'">
                <ion-col size="12">
                  <ion-label class="head">{{"Father/Husband" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.fatherOrHusband}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="12">
                  <ion-label class="head">{{"hemoglobin" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.hemoglobin}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="12">
                  <ion-label class="head">{{"illness" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.illness}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="12">
                  <ion-label class="head">{{"location" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.location}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="12">
                  <ion-label class="head">{{"mobileNo" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.mobileNo}}</ion-label>
                </ion-col>
              </ion-row>

              <ion-row>
                <ion-col size="12">
                  <ion-label class="head">{{"units" | translate}}</ion-label>
                  <ion-label>: {{data?.bloodRequest?.units}}</ion-label>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col *ngIf="data?.user?.id == user.id && data.status == 'ALLOCATED'">
                  <ion-button (click)="statusUpdate('ACCEPTED')">{{"accept" | translate}}</ion-button>
                </ion-col>
                <ion-col *ngIf="data?.user?.id == user.id  && data.status == 'ACCEPTED'">
                  <ion-button (click)="statusUpdate('DONE')">{{"done" | translate}}</ion-button>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-card-content>
        </ion-card>
      </div>
    </ion-accordion>
    <ion-accordion value="third">
      <ion-item slot="header" color="light">
        <i class="fa-solid fa-user"></i>
        <ion-label class="ion-padding-horizontal">{{"personalDetails" | translate}}</ion-label>
      </ion-item>
      <div class="ion-padding" slot="content">
        <ion-card>
          <ion-card-content>
            <ion-grid>

              <ion-row class="ion-justify-content-center">
                <ion-col size="10" class="ion-text-center donarImag-sec ">
                  <!-- <ion-card class="donarImag-sec ion-text-center"> -->


                  <img src="{{donorImage ?? '../../../../assets/photo_2983067.png' }}" alt="mainPofile"
                    class="donorImg" />
                  <ion-icon name="add-circle" class="overlay-icon"></ion-icon>
                  <!-- <ion-icon name="camera-outline"  color=light size="large"></ion-icon> -->
                  <!-- <ion-text color="light">
                          Upload Image While Donating
                        </ion-text> -->

                  <!-- </ion-card> -->


                </ion-col>


                <ion-col size="12">
                  <ion-label class="head">{{"Name" | translate}}</ion-label>
                  <ion-label> : {{data?.name}}</ion-label>
                </ion-col>

                <ion-col size="12">
                  <ion-label class="head">{{"gender" | translate}}</ion-label>
                  <ion-label> : {{data?.gender}}</ion-label>
                </ion-col>

                <ion-col size="12">
                  <ion-label class="head">{{"age" | translate}}</ion-label>
                  <ion-label> : {{data?.age}}</ion-label>
                </ion-col>

                <ion-col size="12">
                  <ion-label class="head">{{"state" | translate}}</ion-label>
                  <ion-label> : {{data?.state}}</ion-label>
                </ion-col>

                <ion-col size="12" *ngIf="!!data.district">
                  <ion-label class="head">{{"District" | translate}}</ion-label>
                  <ion-label> : {{data?.district}}</ion-label>
                </ion-col>

                <ion-col size="12" *ngIf="!!data.tahsil">
                  <ion-label class="head">{{"Tahsil" | translate}}</ion-label>
                  <ion-label> : {{data?.tahsil}}</ion-label>
                </ion-col>

                <ion-col size="12" *ngIf="!!data.village">
                  <ion-label class="head">{{"Village" | translate}}</ion-label>
                  <ion-label> : {{data?.village}}</ion-label>
                </ion-col>

                <ion-col size="12">
                  <ion-label class="head">{{"bloodGroup" | translate}}</ion-label>
                  <ion-label> : {{data?.bloodGroup}}</ion-label>
                </ion-col>

                <ion-col size="12">
                  <ion-label class="head">{{"hemoglobin" | translate}}</ion-label>
                  <ion-label> : {{data?.hemoglobin}}</ion-label>
                </ion-col>

                <ion-col size="12">
                  <ion-label class="head">{{"mobileNo" | translate}}</ion-label>
                  <ion-label> : {{data?.mobileNo}}</ion-label>
                </ion-col>

                <ion-col size="12">
                  <ion-label class="head">{{"donationDate" | translate}}</ion-label>
                  <ion-label> : {{data?.donationDate}}</ion-label>
                </ion-col>

                <ion-col size="12">
                  <ion-icon *ngIf="data?.illness" name="checkbox"></ion-icon>
                  <ion-icon *ngIf="!data?.illness" name="close"></ion-icon>
                  <ion-label class="head donor-illness">{{"illness" | translate}}</ion-label>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-card-content>
        </ion-card>
      </div>
    </ion-accordion>

    <ion-accordion value="fourth"
      *ngIf="data?.user?.id == user.id && (data.status == 'ACCEPTED' || data.status == 'DONE')">
      <ion-item slot="header" color="light">
        <i class="fa-solid fa-user"></i>
        <ion-label class="ion-padding-horizontal">{{"uploadImageWhileDonating" | translate}}</ion-label>
      </ion-item>
      <div class="ion-padding" slot="content">
        <ion-card>
          <ion-card-content>


            <ion-item lines="none" class="margin-img">
              <!-- <ion-avatar class="avatar border-color-7"> -->
              <img class="profile-img" *ngIf="!donorImage"
                src="../../../../assets/icon/73-730477_first-name-profile-image-placeholder-png.png" alt="mainPofile" />
              <img *ngIf="!!donorImage" src="{{donorImage}}" alt="mainPofile" />

              <!-- </ion-avatar> -->
            </ion-item>
            <ion-row class="ion-justify-content-end">
              <ion-icon name="camera" class="cam-icon" (click)="uploadFile()"></ion-icon>
            </ion-row>
          </ion-card-content>
        </ion-card>
      </div>
    </ion-accordion>
  </ion-accordion-group>


  <!-- </ng-template> -->
</ion-content>

<ion-footer *ngIf="data.status == 'PENDING' || data.status == 'ALLOCATED' || data.status == 'ACCEPTED'">
  <ion-toolbar>
    <ion-row class="ion-padding-horizontal ion-justify-content-center">
      <ion-col size="10">
        <ion-button (click)="statusUpdate('CANCEL')" expand="block">{{"cancelRequest" | translate}}</ion-button>

      </ion-col>
    </ion-row>
  </ion-toolbar>
</ion-footer>